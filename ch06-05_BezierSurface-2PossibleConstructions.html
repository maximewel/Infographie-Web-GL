<!DOCTYPE html><html lang="fr"><head><meta charset="utf-8"/><link rel="stylesheet" href="./css/stylesheet.css"><script src="./js/commonFunctions.js"></script><script src='./js/gl-matrix-min.js'></script><script src='./js/webglTools.js'></script><script id="shader-vs" type="x-shader/x-vertex">attribute vec3 aVertexPosition;attribute vec4 aColor;attribute float aAction;uniform mat4 uMVMatrix;uniform mat4 uPMatrix;uniform vec3 uP0;uniform vec3 uP1;uniform vec3 uP2;varying vec4 vColor;void main(void){if(aAction>=1.0){vColor=aColor;float t=aVertexPosition.x;vec3 intermedPosition=(1.0-t) * ((1.0-t) * uP0 + t * uP1) + t * ((1.0-t) * uP1 + t * uP2);gl_Position=uPMatrix * uMVMatrix * vec4(intermedPosition, 1.0);}else{vColor=vec4(0.0,0.0,0.0,1.0);gl_PointSize=5.0;gl_Position=uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);}}</script><script id="shader-fs" type="x-shader/x-fragment">#ifdef GL_ES
	precision highp float;
	#endif
	varying vec4 vColor;void main(void){gl_FragColor=vColor;}</script><script>var vertexBuffer=null;var indexBuffer=null;var colorBuffer=null;var vertexActionBuffer=null;var indices=[];var vertices=[];var colors=[];var vertexAction=[];var mvMatrix=mat4.create();var pMatrix=mat4.create();var translationMat=mat4.create();mat4.identity(mvMatrix);mat4.identity(pMatrix);var referencePoints=[];function initShaderParameters(prg){prg.vertexPositionAttribute=glContext.getAttribLocation(prg, "aVertexPosition");glContext.enableVertexAttribArray(prg.vertexPositionAttribute);prg.colorAttribute=glContext.getAttribLocation(prg, "aColor");glContext.enableVertexAttribArray(prg.colorAttribute);prg.actionAttribute=glContext.getAttribLocation(prg, "aAction");glContext.enableVertexAttribArray(prg.actionAttribute);prg.pMatrixUniform=glContext.getUniformLocation(prg, 'uPMatrix');prg.mvMatrixUniform=glContext.getUniformLocation(prg, 'uMVMatrix');prg.p0Uniform=glContext.getUniformLocation(prg, 'uP0');prg.p1Uniform=glContext.getUniformLocation(prg, 'uP1');prg.p2Uniform=glContext.getUniformLocation(prg, 'uP2');}function initBuffers(){indices=[];vertices=[];colors=[];referencePoints=[];referencePoints.push( 0.18, 0.38, -0.75);referencePoints.push( 0.45, 0.00, -0.80);referencePoints.push( 0.23, -0.39, -0.90);referencePoints.push( 0.05, 0.39, -0.90);referencePoints.push( 0.00, 0.19, -0.55);referencePoints.push( 0.05, -0.09, -0.40);referencePoints.push( -0.23, 0.24, -0.60);referencePoints.push( -0.29, -0.33, -0.60);referencePoints.push( -0.12, -0.20, -0.60);}function linkBuffers(){vertexBuffer=getVertexBufferWithVertices(vertices);indexBuffer=getIndexBufferWithIndices(indices);colorBuffer=getVertexBufferWithVertices(colors);vertexActionBuffer=getVertexBufferWithVertices(vertexAction);}function setBuffersForPoints(){indices=[];vertices=[];colors=[];vertexAction=[];vertices=referencePoints;for(var i=0; i < vertices.length/3; ++i){vertexAction.push(0.0);colors.push( 0.0, 0.0, 1.0, 1.0 );indices.push(i);}linkBuffers();}function setBuffersForLine(r,g,b){indices=[];vertices=[];colors=[];vertexAction=[];var MAX_INTERMEDIATE_POINTS=20.0;for(var i=0; i <=MAX_INTERMEDIATE_POINTS; ++i){var t=1.0/MAX_INTERMEDIATE_POINTS*i;vertices.push( t, 0.0, 10.0 );colors.push( t*r, t*g, t*b, 1.0 );vertexAction.push( 1.0 );}for(var i=0; i < vertices.length/3; ++i){indices.push(i);}linkBuffers();}function drawScene(){glContext.clearColor(0.9, 0.9, 1.0, 1.0);glContext.enable(glContext.DEPTH_TEST);glContext.clear(glContext.COLOR_BUFFER_BIT | glContext.DEPTH_BUFFER_BIT);glContext.viewport(0, 0, c_width, c_height);mat4.perspective(pMatrix, degToRad(60), c_width / c_height, 0.1, 1000.0);var tx=0.0;var ty=0.0;var tz=-2.0;translationMat=mat4.create();mat4.identity(translationMat);mat4.translate(translationMat, translationMat, [tx, ty, tz]);rotateModelViewMatrixUsingQuaternion();glContext.uniformMatrix4fv(prg.pMatrixUniform, false, pMatrix);mvtMatrix=mat4.create();glContext.uniformMatrix4fv(prg.mvMatrixUniform, false, mat4.multiply(mvtMatrix, translationMat, mvMatrix));mat4.identity(mvMatrix);setBuffersForPoints();drawVertexSet(glContext.POINTS);for(i=0; i < 3; i++){var offset=i * 9;glContext.uniform3fv(prg.p0Uniform, referencePoints.slice(offset + 0, offset + 3));glContext.uniform3fv(prg.p1Uniform, referencePoints.slice(offset + 3, offset + 6));glContext.uniform3fv(prg.p2Uniform, referencePoints.slice(offset + 6, offset + 9));setBuffersForLine(0.0,1.0,0.0);drawVertexSet(glContext.LINE_STRIP);}for(i=0; i < 3; i++){var offset=i * 3;glContext.uniform3fv(prg.p0Uniform, referencePoints.slice(offset + 0, offset + 3));glContext.uniform3fv(prg.p1Uniform, referencePoints.slice(offset + 9, offset + 12));glContext.uniform3fv(prg.p2Uniform, referencePoints.slice(offset + 18, offset + 21));setBuffersForLine(1.0,0.0,0.0);drawVertexSet(glContext.LINE_STRIP);}}function drawVertexSet(style){glContext.bindBuffer(glContext.ARRAY_BUFFER, vertexBuffer);glContext.vertexAttribPointer(prg.vertexPositionAttribute, 3, glContext.FLOAT, false, 0, 0);glContext.bindBuffer(glContext.ARRAY_BUFFER, colorBuffer);glContext.vertexAttribPointer(prg.colorAttribute, 4, glContext.FLOAT, false, 0, 0);glContext.bindBuffer(glContext.ARRAY_BUFFER, vertexActionBuffer);glContext.vertexAttribPointer(prg.actionAttribute, 1, glContext.FLOAT, false, 0, 0);glContext.bindBuffer(glContext.ELEMENT_ARRAY_BUFFER, indexBuffer);glContext.drawElements(style, indices.length, glContext.UNSIGNED_SHORT,0);}function initWebGL(){glContext=getGLContext('webgl-canvas');initProgram();initBuffers();renderLoop();}</script></head><body onload="initWebGL()"><script>displayTitle("Ch.06 Ex.5 : Construction de base pour une surface de Bézier", 1,1,1,1,1,1,1);</script><p>Interaction utilisateur: utiliser la souris pour faire tourner la camera autour de la surface de Bézier.</p><canvas id="webgl-canvas" width="1000" height="1000">HTML5 is not supported</canvas></body><script src='./js/mouseMotionHandling.js'></script></html>